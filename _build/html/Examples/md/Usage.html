
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Observing-Suite &#8212; Observing Suite Manual</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script >const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Observing Suite Manual</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../README.html">
   Observing Suite
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Manual
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Overview.html">
   Observing-Suite
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  API
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../api.html">
   API documentation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../_autosummary/observing_suite.html">
     observing_suite
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../_autosummary/observing_suite.imaging.html">
       observing_suite.imaging
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../_autosummary/observing_suite.observing_log.html">
       observing_suite.observing_log
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../_autosummary/observing_suite.observing_plan.html">
       observing_suite.observing_plan
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../_autosummary/observing_suite.target.html">
       observing_suite.target
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/Examples/md/Usage.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dependencies">
   Dependencies
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#usage">
   Usage
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-target-class">
     The Target() Class
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adding-configurations">
     Adding Configurations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#removing-and-editing-configurations">
     Removing and Editing Configurations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#retrieving-finder-charts">
     Retrieving Finder Charts
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adding-custom-imaging">
     Adding Custom Imaging
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#summary">
     Summary
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#observing-plans">
   Observing Plans
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#altitude-airmass-plot">
     Altitude / Airmass Plot
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#observing-plan-html-output">
   Observing Plan HTML Output
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Observing-Suite</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dependencies">
   Dependencies
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#usage">
   Usage
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-target-class">
     The Target() Class
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adding-configurations">
     Adding Configurations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#removing-and-editing-configurations">
     Removing and Editing Configurations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#retrieving-finder-charts">
     Retrieving Finder Charts
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adding-custom-imaging">
     Adding Custom Imaging
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#summary">
     Summary
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#observing-plans">
   Observing Plans
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#altitude-airmass-plot">
     Altitude / Airmass Plot
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#observing-plan-html-output">
   Observing Plan HTML Output
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="observing-suite">
<h1>Observing-Suite<a class="headerlink" href="#observing-suite" title="Permalink to this headline">¶</a></h1>
<p>A suite of tools for planning and carrying out astronomical observations, building on astropy and inspired by astroplan.</p>
<p>This package is built around three core classes: <code class="docutils literal notranslate"><span class="pre">Target()</span></code>, where one specifies astronomical targets and various configurations of desired target, <code class="docutils literal notranslate"><span class="pre">ObservingPlan()</span></code>, which ingests a target list, sets up the observatory and nights of observation, creates <em>beautiful</em> html observing plans (with airmass plots, finder charts, etc) and exports observatory-ready target lists for all unique configurations, and <code class="docutils literal notranslate"><span class="pre">ObservingLog()</span></code>, which spawns an easy to use, but highly flexible, html entry tool that saves an observing log during the night.</p>
<p>Numerous convenience functions exist at each stage: my goal is to make it as easy as possible for me (and others) to set up complex observing runs yet keep track of everything. Some elements of this package are made better with instrument specific and observatory specific information. For now, Keck Observatory and Palomar Observatory are the two “most supported”. I’ll happily add more if people are interested and can provide, e.g., the template for that observatory’s targetlist.</p>
<div class="section" id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h2>
<p>Use of the observing-suite relies on the following</p>
<ul class="simple">
<li><p>numpy</p></li>
<li><p>matplotlib</p></li>
<li><p>astropy</p></li>
<li><p>pandas</p></li>
<li><p>photutils</p></li>
<li><p>astroquery</p></li>
</ul>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>Below, I demonstrate some of the basic usage of the tool.</p>
<div class="section" id="the-target-class">
<h3>The Target() Class<a class="headerlink" href="#the-target-class" title="Permalink to this headline">¶</a></h3>
<p>Our observing plan (later on) is going to ingest a list of <code class="docutils literal notranslate"><span class="pre">Target</span></code>s. Let’s go ahead and define one, and see what convenience functions exist. As a note, if your observations are in the vicinity of a known (i.e., resolvable by <code class="docutils literal notranslate"><span class="pre">Simbad</span></code>) source, you can simply enter the name, leaving the <code class="docutils literal notranslate"><span class="pre">parse_name</span></code> argument to <code class="docutils literal notranslate"><span class="pre">True</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">observing_suite</span> <span class="kn">import</span> <span class="n">Target</span><span class="p">,</span> <span class="n">ObservingPlan</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m82</span> <span class="o">=</span> <span class="n">Target</span><span class="p">(</span><span class="s1">&#39;M82&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>With our target defined, we also have a set of coordinates that are accessible (this worked because the resolved name provided the coordinates).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m82</span><span class="o">.</span><span class="n">coordinates</span><span class="o">.</span><span class="n">to_string</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&#39;148.968 69.6797&#39;
</pre></div>
</div>
<p>The coordinates are standard <code class="docutils literal notranslate"><span class="pre">astropy.coordinates.SkyCoord</span></code> objects. Naturally, you can provide <code class="docutils literal notranslate"><span class="pre">SkyCoord</span></code> objects directly into the <code class="docutils literal notranslate"><span class="pre">Target</span></code> class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">SkyCoord</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="n">target_coord</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="s1">&#39;148.152 70.1215&#39;</span><span class="p">,</span><span class="n">unit</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span>

<span class="n">custom_target</span> <span class="o">=</span> <span class="n">Target</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;my galaxy&#39;</span><span class="p">,</span><span class="n">coordinates</span><span class="o">=</span><span class="n">target_coord</span><span class="p">,</span><span class="n">parse_name</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>And finally, <code class="docutils literal notranslate"><span class="pre">Target()</span></code> provides the ability to supply coordinates without invoking SkyCoord directly. You can pass a string of coordinates (ra and dec), along with the keyword argument <code class="docutils literal notranslate"><span class="pre">coord_units</span></code>, which get fed to <code class="docutils literal notranslate"><span class="pre">SkyCoord</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">final_target</span> <span class="o">=</span> <span class="n">Target</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;final_galaxy&#39;</span><span class="p">,</span><span class="n">coordinates</span><span class="o">=</span><span class="s1">&#39;147.225 68.4242&#39;</span><span class="p">,</span><span class="n">coord_units</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">),</span><span class="n">parse_name</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>In this case, I’ve demonstrated you can pass <code class="docutils literal notranslate"><span class="pre">coord_units</span></code> as a tuple of <code class="docutils literal notranslate"><span class="pre">astropy.Quantity</span></code> objects, but in this case, the string <code class="docutils literal notranslate"><span class="pre">'deg'</span></code> would’ve been fine too.</p>
<p>Also notice that I’ve given these <code class="docutils literal notranslate"><span class="pre">Target</span></code>s names — this will allow us to display and organize our targets moving forward.</p>
</div>
<div class="section" id="adding-configurations">
<h3>Adding Configurations<a class="headerlink" href="#adding-configurations" title="Permalink to this headline">¶</a></h3>
<p>Every <code class="docutils literal notranslate"><span class="pre">Target</span></code> must have at least 1 valid <code class="docutils literal notranslate"><span class="pre">configuration</span></code>. A configuration refers to a specific way in which this object will be observed. One can add as many configurations as desired, which can be useful if, for example, you wish to perform spectroscopy on a target with varying PA angles or slit widths or gratings, or image a source in different filters.</p>
<p>Let’s add a configuration now. The most basic form of configuration doesn’t specify <em>any</em> additional parameters:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m82</span><span class="o">.</span><span class="n">add_configuration</span><span class="p">(</span><span class="n">config_name</span><span class="o">=</span><span class="s1">&#39;primary&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Notice that we also name our configurations, which will matter later for organization. At any time, we can visualize the configurations we’ve defined by the attribute</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m82</span><span class="o">.</span><span class="n">configurations</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</pre></div>
</div>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>obstype</th>
      <th>coordinates</th>
    </tr>
    <tr>
      <th>configurations</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>primary</th>
      <td>---</td>
      <td>148.968 69.6797</td>
    </tr>
  </tbody>
</table>
</div>
<p>or by running the explicit method</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m82</span><span class="o">.</span><span class="n">list_configurations</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</pre></div>
</div>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>obstype</th>
      <th>coordinates</th>
    </tr>
    <tr>
      <th>configurations</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>primary</th>
      <td>---</td>
      <td>148.968 69.6797</td>
    </tr>
  </tbody>
</table>
</div>
<p>The configurations are visualized using <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>s, and you can take these frames and work with them as you wish. However, note that the DataFrame is only a <em>view</em> of your configurations, and modifying the returned frame doesn’t modify your underlying configurations.</p>
<p>We can notice here that this configuration has an <code class="docutils literal notranslate"><span class="pre">obstype</span></code> (unfilled), and <code class="docutils literal notranslate"><span class="pre">coordinates</span></code>, which were automagically set — because we didn’t specify any here, <em>and</em> the target itself had coordinates defined, they were pulled from there. It would’ve been <code class="docutils literal notranslate"><span class="pre">None</span></code> if we had initialized our <code class="docutils literal notranslate"><span class="pre">Target</span></code> without any coordinates (e.g., by supplying a non-parsed name and not providing coordinates).</p>
<p>The configurations are supposed to be as flexible as possible, but certain <em>special</em> keywords also unlock special convenience functions. Let’s re-do our primary configuration with some more flair:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m82</span><span class="o">.</span><span class="n">add_configuration</span><span class="p">(</span><span class="n">config_name</span><span class="o">=</span><span class="s1">&#39;primary&#39;</span><span class="p">,</span>
                      <span class="n">obstype</span><span class="o">=</span><span class="s1">&#39;spectroscopy&#39;</span><span class="p">,</span>
                      <span class="n">slit_length</span><span class="o">=</span><span class="mi">128</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">arcsec</span><span class="p">,</span>
                      <span class="n">slit_width</span><span class="o">=</span><span class="mf">1.5</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">arcsec</span><span class="p">,</span>
                      <span class="n">PA</span><span class="o">=</span><span class="mi">60</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Config Name primary already a configuration. Overwrite? [Enter yes, N for no]:  
</pre></div>
</div>
<p>Notice that we got a nice warning about overwriting our previous configuration with the same name!</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m82</span><span class="o">.</span><span class="n">configurations</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</pre></div>
</div>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>obstype</th>
      <th>coordinates</th>
      <th>slit_length</th>
      <th>slit_width</th>
      <th>PA</th>
    </tr>
    <tr>
      <th>configurations</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>primary</th>
      <td>spectroscopy</td>
      <td>148.968 69.6797</td>
      <td>128.0 arcsec</td>
      <td>1.5 arcsec</td>
      <td>60.0 deg</td>
    </tr>
  </tbody>
</table>
</div>
<p>We now have a more interesting configuration set for our “primary” configuration. I want to stress that the <code class="docutils literal notranslate"><span class="pre">add_configuration()</span></code> method will allow you to add any number of extra keywords and values, which will then be stored and accesible. So whatever quick-look info is useful to your observations, you should add.</p>
<p>Let’s add a secondary configuration:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m82</span><span class="o">.</span><span class="n">add_configuration</span><span class="p">(</span><span class="n">config_name</span><span class="o">=</span><span class="s1">&#39;secondary&#39;</span><span class="p">,</span>
                      <span class="n">obstype</span><span class="o">=</span><span class="s1">&#39;spectroscopy&#39;</span><span class="p">,</span>
                      <span class="n">slit_length</span><span class="o">=</span><span class="mi">128</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">arcsec</span><span class="p">,</span>
                      <span class="n">slit_width</span><span class="o">=</span><span class="mi">4</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">arcsec</span><span class="p">,</span>
                      <span class="n">PA</span><span class="o">=</span><span class="mi">120</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m82</span><span class="o">.</span><span class="n">configurations</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</pre></div>
</div>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>obstype</th>
      <th>coordinates</th>
      <th>slit_length</th>
      <th>slit_width</th>
      <th>PA</th>
    </tr>
    <tr>
      <th>configurations</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>primary</th>
      <td>spectroscopy</td>
      <td>148.968 69.6797</td>
      <td>128.0 arcsec</td>
      <td>1.5 arcsec</td>
      <td>60.0 deg</td>
    </tr>
    <tr>
      <th>secondary</th>
      <td>spectroscopy</td>
      <td>148.968 69.6797</td>
      <td>128.0 arcsec</td>
      <td>4.0 arcsec</td>
      <td>120.0 deg</td>
    </tr>
  </tbody>
</table>
</div>
<p>We now have a new configuration, specifying new slit width and PA. Nothing stops us from adding unique columns that only apply to some configurations:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m82</span><span class="o">.</span><span class="n">add_configuration</span><span class="p">(</span><span class="n">config_name</span><span class="o">=</span><span class="s1">&#39;tertiary&#39;</span><span class="p">,</span>
                      <span class="n">obstype</span><span class="o">=</span><span class="s1">&#39;fiber spectroscopy&#39;</span><span class="p">,</span>
                      <span class="n">fiber_radius</span><span class="o">=</span><span class="mi">30</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">arcsec</span><span class="p">)</span>
<span class="n">m82</span><span class="o">.</span><span class="n">configurations</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</pre></div>
</div>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>obstype</th>
      <th>coordinates</th>
      <th>slit_length</th>
      <th>slit_width</th>
      <th>PA</th>
      <th>fiber_radius</th>
    </tr>
    <tr>
      <th>configurations</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>primary</th>
      <td>spectroscopy</td>
      <td>148.968 69.6797</td>
      <td>128.0 arcsec</td>
      <td>1.5 arcsec</td>
      <td>60.0 deg</td>
      <td>---</td>
    </tr>
    <tr>
      <th>secondary</th>
      <td>spectroscopy</td>
      <td>148.968 69.6797</td>
      <td>128.0 arcsec</td>
      <td>4.0 arcsec</td>
      <td>120.0 deg</td>
      <td>---</td>
    </tr>
    <tr>
      <th>tertiary</th>
      <td>fiber spectroscopy</td>
      <td>148.968 69.6797</td>
      <td>---</td>
      <td>---</td>
      <td>---</td>
      <td>30.0 arcsec</td>
    </tr>
  </tbody>
</table>
</div>
<p>This time, I’ve assumed we have a fiber with a radius, rather than a slit with a length and width.</p>
<p>People familiar with faint object spectroscopy will be familiar with the concept of an offset star. You align on this (visible) source, and execute a blind offset to the target (hoping you got it right).</p>
<p>We provide the functionality to add an offset star for any configuration, and the code will also calculate our offsets:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m82</span><span class="o">.</span><span class="n">add_offset_star</span><span class="p">(</span><span class="n">coordinate</span><span class="o">=</span><span class="s1">&#39;148.928 69.6897&#39;</span><span class="p">,</span>
                    <span class="n">coord_units</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">,</span>
                    <span class="n">configurations</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">m82</span><span class="o">.</span><span class="n">configurations</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</pre></div>
</div>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>obstype</th>
      <th>coordinates</th>
      <th>slit_length</th>
      <th>slit_width</th>
      <th>PA</th>
      <th>offset star</th>
      <th>offsets</th>
      <th>fiber_radius</th>
    </tr>
    <tr>
      <th>configurations</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>primary</th>
      <td>spectroscopy</td>
      <td>148.968 69.6797</td>
      <td>128.0 arcsec</td>
      <td>1.5 arcsec</td>
      <td>60.0 deg</td>
      <td>148.928 69.6897</td>
      <td>50.580 arcsec'' E, -35.973 arcsec'' N</td>
      <td>---</td>
    </tr>
    <tr>
      <th>secondary</th>
      <td>spectroscopy</td>
      <td>148.968 69.6797</td>
      <td>128.0 arcsec</td>
      <td>4.0 arcsec</td>
      <td>120.0 deg</td>
      <td>148.928 69.6897</td>
      <td>50.580 arcsec'' E, -35.973 arcsec'' N</td>
      <td>---</td>
    </tr>
    <tr>
      <th>tertiary</th>
      <td>fiber spectroscopy</td>
      <td>148.968 69.6797</td>
      <td>---</td>
      <td>---</td>
      <td>---</td>
      <td>148.928 69.6897</td>
      <td>50.580 arcsec'' E, -35.973 arcsec'' N</td>
      <td>30.0 arcsec</td>
    </tr>
  </tbody>
</table>
</div>
<p>I’ve supplied the coordinates for our offset star, which in this case can be applied to all configurations, because all our configurations have the same coordinates. But if you have different specific coordinates for each configuration, it would calculate the offsets from that star to each. You can also specify to add offsets only to one, or some, configurations (via a string name, or a list of string names of configurations).</p>
</div>
<div class="section" id="removing-and-editing-configurations">
<h3>Removing and Editing Configurations<a class="headerlink" href="#removing-and-editing-configurations" title="Permalink to this headline">¶</a></h3>
<p>There are some convenience methods to allow you to <code class="docutils literal notranslate"><span class="pre">remove_configuration(config_name)</span></code> and <code class="docutils literal notranslate"><span class="pre">edit_configuration(config_name,property,value)</span></code> which are pretty self-explanatory. Editing is not super useful — you might as well change and readd (overwrite) your entry for that configuration.</p>
</div>
<div class="section" id="retrieving-finder-charts">
<h3>Retrieving Finder Charts<a class="headerlink" href="#retrieving-finder-charts" title="Permalink to this headline">¶</a></h3>
<p>We can retrieve a DSS image (finder chart) for any configuration which has coordinates defined.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m82</span><span class="o">.</span><span class="n">retrieve_finder_chart</span><span class="p">(</span><span class="n">config_name</span><span class="o">=</span><span class="s1">&#39;primary&#39;</span><span class="p">,</span>
                         <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">arcmin</span><span class="p">,</span>
                         <span class="n">show_aperture</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>WARNING: AstropyDeprecationWarning: The truth value of a Quantity is ambiguous. In the future this will raise a ValueError. [astropy.units.quantity]
</pre></div>
</div>
<p><img alt="png" src="../../_images/output_28_1.png" /></p>
<p>In relieving news, M82 appears! Notice I set a specific keyword to <em>not</em> show aperture. What was that about?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m82</span><span class="o">.</span><span class="n">retrieve_finder_chart</span><span class="p">(</span><span class="n">config_name</span><span class="o">=</span><span class="s1">&#39;primary&#39;</span><span class="p">,</span>
                         <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">arcmin</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>WARNING: AstropyDeprecationWarning: The truth value of a Quantity is ambiguous. In the future this will raise a ValueError. [astropy.units.quantity]
</pre></div>
</div>
<p><img alt="png" src="../../_images/output_30_1.png" /></p>
<p>When we have a configuration that has the special keywords <code class="docutils literal notranslate"><span class="pre">slit_width</span></code>, <code class="docutils literal notranslate"><span class="pre">slit_length</span></code> and <code class="docutils literal notranslate"><span class="pre">PA</span></code> defined, we can use this to overplot our slit onto our finder chart.</p>
<p>The same is true for the fiber / circular aperture, because we set <code class="docutils literal notranslate"><span class="pre">fiber_radius</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m82</span><span class="o">.</span><span class="n">retrieve_finder_chart</span><span class="p">(</span><span class="n">config_name</span><span class="o">=</span><span class="s1">&#39;tertiary&#39;</span><span class="p">,</span>
                         <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">arcmin</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>WARNING: AstropyDeprecationWarning: The truth value of a Quantity is ambiguous. In the future this will raise a ValueError. [astropy.units.quantity]
</pre></div>
</div>
<p><img alt="png" src="../../_images/output_32_1.png" /></p>
</div>
<div class="section" id="adding-custom-imaging">
<h3>Adding Custom Imaging<a class="headerlink" href="#adding-custom-imaging" title="Permalink to this headline">¶</a></h3>
<p>The final convenience function to cover here is that if you have your own image of your target (maybe from your own telescope) and you wish to add it to your configuration, you can do so with the <code class="docutils literal notranslate"><span class="pre">add_custom_image()</span></code> method. (See the API for more).</p>
</div>
<div class="section" id="summary">
<h3>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h3>
<p>So far, we’ve covered the <code class="docutils literal notranslate"><span class="pre">Target()</span></code> class and how to define targets and set configurations with any number of quantities of interest to us. We also covered a few of the convenient functions we can apply directly onto <code class="docutils literal notranslate"><span class="pre">Target</span></code>s. Most of these come together in our next part: <code class="docutils literal notranslate"><span class="pre">ObservingPlan()</span></code>.</p>
</div>
</div>
<div class="section" id="observing-plans">
<h2>Observing Plans<a class="headerlink" href="#observing-plans" title="Permalink to this headline">¶</a></h2>
<p>Once we have our targets and their configurations set up as desired, we can ingest these into an observing plan. To do so, we’ll need to initialize an <code class="docutils literal notranslate"><span class="pre">ObservingPlan</span></code> object with a list of our <code class="docutils literal notranslate"><span class="pre">Target</span></code>s as well as the dates of our observations and the location they will be at. To make things more interesting, let’s define a second target:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m101</span> <span class="o">=</span> <span class="n">Target</span><span class="p">(</span><span class="s1">&#39;M101&#39;</span><span class="p">)</span>
<span class="n">m101</span><span class="o">.</span><span class="n">add_configuration</span><span class="p">(</span><span class="n">config_name</span><span class="o">=</span><span class="s1">&#39;on-target&#39;</span><span class="p">,</span>
                    <span class="n">obstype</span><span class="o">=</span><span class="s1">&#39;spectroscopy&#39;</span><span class="p">,</span>
                    <span class="n">PA</span> <span class="o">=</span> <span class="o">-</span><span class="mi">120</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span>
                    <span class="n">slit_length</span><span class="o">=</span><span class="mi">128</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">arcsec</span><span class="p">,</span>
                    <span class="n">slit_width</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">arcsec</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">targets</span> <span class="o">=</span> <span class="p">[</span><span class="n">m82</span><span class="p">,</span><span class="n">m101</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plan</span> <span class="o">=</span> <span class="n">ObservingPlan</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span>
                     <span class="n">observatory</span><span class="o">=</span><span class="s1">&#39;Palomar&#39;</span><span class="p">,</span>
                     <span class="n">obsdates</span><span class="o">=</span><span class="s1">&#39;2022-02-25&#39;</span><span class="p">,</span>
                     <span class="n">utcoffset</span><span class="o">=-</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
<p>Above, we’ve set up an <code class="docutils literal notranslate"><span class="pre">ObservingPlan</span></code> with our targets. We’ve specified our observatory as <code class="docutils literal notranslate"><span class="pre">Palomar</span></code>. Any Observatory in the <code class="docutils literal notranslate"><span class="pre">astropy</span></code> database can be used, or, if you have a custom location, you can easily setup an astropy <code class="docutils literal notranslate"><span class="pre">EarthLocation()</span></code> object (which takes a latitude, longitude, and altitude). This can also be directly added.</p>
<p>I’ve also set the <code class="docutils literal notranslate"><span class="pre">obsdates</span></code> params. In this case, I provided a single string, but a list of similar strings can be added to put in an observing run. Though if you have different targets for each night, you may wish to separate those out. Finally, we specify the utc offset of the observatory… there’s probably a way for me to automate this, but for now just do it.</p>
<div class="section" id="altitude-airmass-plot">
<h3>Altitude / Airmass Plot<a class="headerlink" href="#altitude-airmass-plot" title="Permalink to this headline">¶</a></h3>
<p>Immediately upon making our plan, we have access to a useful method.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plan</span><span class="o">.</span><span class="n">plot_visibility</span><span class="p">(</span><span class="s1">&#39;2022-02-25&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p><img alt="png" src="../../_images/output_38_0.png" /></p>
<p>By default, this plot will show each target as well as the moon. It shows your standard nighttime, 18 degree twilight, and 12 degree twilight lines. Here’s an example of some of the keywords:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plan</span><span class="o">.</span><span class="n">plot_visibility</span><span class="p">(</span><span class="s1">&#39;2022-02-25&#39;</span><span class="p">,</span><span class="n">target</span><span class="o">=</span><span class="s1">&#39;M82&#39;</span><span class="p">,</span><span class="n">view_range</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">10</span><span class="p">));</span>
</pre></div>
</div>
<p><img alt="png" src="../../_images/output_40_0.png" /></p>
<p>So we can set the range (about midnight) that gets shown, we can specify individual targets (or provide a list of targets as strings), and manually set the figure size.</p>
</div>
</div>
<div class="section" id="observing-plan-html-output">
<h2>Observing Plan HTML Output<a class="headerlink" href="#observing-plan-html-output" title="Permalink to this headline">¶</a></h2>
<p>The first major thing we can do with our observing plan is, in essence, have it loop over all our targets and put together a unified observing guide which has the full visibility plot, then for each target, shows its visibility plot, its configurations, and its finder images.</p>
<p>This stage is still under construction, but is (marginally) functional, via</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plan</span><span class="o">.</span><span class="n">html_summary</span><span class="p">(</span><span class="s1">&#39;2022-02-25&#39;</span><span class="p">,</span><span class="n">save_dir</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Which will create a folder for that date, and within make the html (and an <code class="docutils literal notranslate"><span class="pre">img</span></code> folder for the plots).</p>
<p>You can see an example of this in the <code class="docutils literal notranslate"><span class="pre">Examples/</span></code> folder.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Examples/md"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Imad Pasha<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>